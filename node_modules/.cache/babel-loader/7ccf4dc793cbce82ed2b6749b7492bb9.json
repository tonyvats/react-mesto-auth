{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _toConsumableArray from\"/Users/vatc/Desktop/praktikum/mesto-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/vatc/Desktop/praktikum/mesto-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import'../index.js';import Header from'../components/Header';import Footer from'../components/Footer';import Main from'../components/Main';import AddPlacePopup from'../components/AddPlacePopup';import EditProfilePopup from'./EditProfilePopup';import EditAvatarPopup from'./EditAvatarPopup';import ImagePopup from'../components/ImagePopup';import{CurrentUserContext}from'../contexts/CurrentUserContext';import api from'../utils/Api';function App(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),isEditAvatarPopupOpen=_React$useState2[0],setIsOpenPopupAvatar=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isEditProfilePopupOpen=_React$useState4[0],setIsOpenPopupProfile=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isAddPlacePopupOpen=_React$useState6[0],setIsOpenPopupPlace=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),selectedCard=_React$useState8[0],setSelectedCard=_React$useState8[1];var _React$useState9=React.useState(null),_React$useState10=_slicedToArray(_React$useState9,2),imageData=_React$useState10[0],setImageData=_React$useState10[1];var _React$useState11=React.useState([]),_React$useState12=_slicedToArray(_React$useState11,2),cards=_React$useState12[0],setCards=_React$useState12[1];var _React$useState13=React.useState(\"\"),_React$useState14=_slicedToArray(_React$useState13,2),currentUser=_React$useState14[0],setCurrentUser=_React$useState14[1];React.useEffect(function(){Promise.all([api.getUserInfoFromServer(),api.getCardsInformation()]).then(function(res){console.log(res);setCurrentUser(res[0]);setCards(res[1]);}).catch(function(err){return console.error(err);});},[]);function handleEditAvatarClick(){setIsOpenPopupAvatar(true);}function handleAddPlaceClick(){setIsOpenPopupPlace(true);}function handleEditProfileClick(){setIsOpenPopupProfile(true);}function handleCardLike(card){// Снова проверяем, есть ли уже лайк на этой карточке\nvar isLiked=card.likes.some(function(i){return i._id===currentUser._id;});// Отправляем запрос в API и получаем обновлённые данные карточки\napi.changeLikeCardStatus(card._id,!isLiked).then(function(newCard){// Формируем новый массив на основе имеющегося, подставляя в него новую карточку\nvar newCards=cards.map(function(c){return c._id===card._id?newCard:c;});// Обновляем стейт\nsetCards(newCards);}).catch(function(err){return console.error(err);});}function handleCardDelete(card){// Отправляем запрос в API и получаем обновлённые данные карточки\napi.deleteCard(card._id).then(function(){setCards(cards.filter(function(c){return c._id!==card._id;}));}).catch(function(err){return console.error(err);});}function handleUpdateUser(userData){api.setUserInfoOnServer(userData.name,userData.about).then(function(res){setCurrentUser(res);closeAllPopups();closeAllPopups();}).catch(function(err){return console.error(err);});}function handleUpdateAvatar(userData){api.editProfileAvatar(userData.avatar).then(function(res){setCurrentUser(res);closeAllPopups();}).catch(function(err){return console.error(err);});}function handleAddPlaceSubmit(cardData){// console.log(cards);\napi.addCards(cardData.name,cardData.link).then(function(card){console.log(cards);setCards([card].concat(_toConsumableArray(cards)));closeAllPopups();}).catch(function(err){return console.error(err);});}function handleCardClick(card){setSelectedCard(true);setImageData(card);}function closeAllPopups(){setIsOpenPopupAvatar(false);setIsOpenPopupProfile(false);setIsOpenPopupPlace(false);setSelectedCard(null);}return/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsxs(CurrentUserContext.Provider,{value:currentUser,children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Main,{onEditAvatar:handleEditAvatarClick,onEditProfile:handleEditProfileClick,onAddPlace:handleAddPlaceClick,onCardClick:handleCardClick,onCardList:cards,onCardLike:handleCardLike,onDeleteCard:handleCardDelete}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddCard:handleAddPlaceSubmit}),/*#__PURE__*/_jsx(ImagePopup,{card:imageData,isOpen:selectedCard,onClose:closeAllPopups}),/*#__PURE__*/_jsx(\"div\",{className:\"popup popup__submit\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"popup__container\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"popup__close-btn\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"popup__content\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"popup__title popup__title_submit\",children:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B?\"}),/*#__PURE__*/_jsx(\"form\",{name:\"submit\",className:\"popup__form popup__form_update\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"popup__save-btn popup__save-btn_confirm\",children:\"\\u0414\\u0430\"})})]})]})})]})});}export default App;","map":{"version":3,"sources":["/Users/vatc/Desktop/praktikum/mesto-react/src/components/App.js"],"names":["React","Header","Footer","Main","AddPlacePopup","EditProfilePopup","EditAvatarPopup","ImagePopup","CurrentUserContext","api","App","useState","isEditAvatarPopupOpen","setIsOpenPopupAvatar","isEditProfilePopupOpen","setIsOpenPopupProfile","isAddPlacePopupOpen","setIsOpenPopupPlace","selectedCard","setSelectedCard","imageData","setImageData","cards","setCards","currentUser","setCurrentUser","useEffect","Promise","all","getUserInfoFromServer","getCardsInformation","then","res","console","log","catch","err","error","handleEditAvatarClick","handleAddPlaceClick","handleEditProfileClick","handleCardLike","card","isLiked","likes","some","i","_id","changeLikeCardStatus","newCard","newCards","map","c","handleCardDelete","deleteCard","filter","handleUpdateUser","userData","setUserInfoOnServer","name","about","closeAllPopups","handleUpdateAvatar","editProfileAvatar","avatar","handleAddPlaceSubmit","cardData","addCards","link","handleCardClick"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../index.js';\nimport Header from '../components/Header';\nimport Footer from '../components/Footer';\nimport Main from '../components/Main';\nimport AddPlacePopup from '../components/AddPlacePopup';\nimport EditProfilePopup from './EditProfilePopup';\nimport EditAvatarPopup from './EditAvatarPopup';\nimport ImagePopup from '../components/ImagePopup';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext';\nimport api from '../utils/Api';\n\nfunction App() {\n\n    const [isEditAvatarPopupOpen, setIsOpenPopupAvatar] = React.useState(false);\n    const [isEditProfilePopupOpen, setIsOpenPopupProfile] = React.useState(false);\n    const [isAddPlacePopupOpen, setIsOpenPopupPlace] = React.useState(false);\n    const [selectedCard, setSelectedCard] = React.useState(false);\n    const [imageData, setImageData] = React.useState(null)\n    \n    const [cards, setCards] = React.useState([])\n    const [currentUser,  setCurrentUser] = React.useState(\"\"); \n        \n    React.useEffect(() => {\n        Promise.all([api.getUserInfoFromServer(), api.getCardsInformation()])\n            .then(res => {\n                console.log(res)\n                setCurrentUser(res[0]);\n                setCards(res[1]);\n            })\n            .catch((err) => console.error(err));\n      }, []);\n\n    function handleEditAvatarClick() {\n        setIsOpenPopupAvatar(true);\n    }\n    \n    function handleAddPlaceClick() {\n        setIsOpenPopupPlace(true);\n    }\n\n    function handleEditProfileClick() {\n        setIsOpenPopupProfile(true);\n    }\n\n    function handleCardLike(card) {\n        // Снова проверяем, есть ли уже лайк на этой карточке\n        const isLiked = card.likes.some(i => i._id === currentUser._id);\n        \n        // Отправляем запрос в API и получаем обновлённые данные карточки\n        api.changeLikeCardStatus(card._id, !isLiked).then((newCard) => {\n            // Формируем новый массив на основе имеющегося, подставляя в него новую карточку\n          const newCards = cards.map((c) => c._id === card._id ? newCard : c);\n          // Обновляем стейт\n          setCards(newCards);\n        })\n        .catch((err) => console.error(err));\n    } \n\n    function handleCardDelete(card) {\n        // Отправляем запрос в API и получаем обновлённые данные карточки\n        api.deleteCard(card._id)\n            .then(() => {\n                setCards(cards.filter(c => c._id !== card._id));\n        })\n        .catch((err) => console.error(err));\n    }\n    \n    function handleUpdateUser(userData) {\n        api.setUserInfoOnServer(userData.name, userData.about)\n            .then(res => {\n                setCurrentUser(res);\n                closeAllPopups();\n                closeAllPopups()\n        })\n        .catch((err) => console.error(err))\n    }\n\n    function handleUpdateAvatar(userData) {\n        api.editProfileAvatar(userData.avatar)\n            .then(res => {\n                setCurrentUser(res);\n                closeAllPopups()\n        })\n        .catch((err) => console.error(err))\n\n    }\n\n    function handleAddPlaceSubmit(cardData) {\n        // console.log(cards);\n        api.addCards(cardData.name, cardData.link)\n            .then(card => {\n                console.log(cards)\n                setCards([card, ...cards]);\n                closeAllPopups()\n        })\n        .catch((err) => console.error(err))\n    }\n\n    function handleCardClick(card) {        \n        setSelectedCard(true);\n        setImageData(card);\n    }\n\n    function closeAllPopups() {\n        setIsOpenPopupAvatar(false);\n        setIsOpenPopupProfile(false);\n        setIsOpenPopupPlace(false);\n        setSelectedCard(null);\n    }\n\n    return (\n        <div className=\"page\">\n            <CurrentUserContext.Provider value={currentUser}>\n                <Header />    \n                <Main\n                    onEditAvatar={handleEditAvatarClick}\n                    onEditProfile={handleEditProfileClick}\n                    onAddPlace={handleAddPlaceClick}\n                    onCardClick={handleCardClick}\n                    onCardList={cards}\n                    onCardLike={handleCardLike}\n                    onDeleteCard={handleCardDelete}\n                />  \n                <Footer />\n\n                <EditProfilePopup \n                    isOpen={isEditProfilePopupOpen} \n                    onClose={closeAllPopups} \n                    onUpdateUser={handleUpdateUser}\n                /> \n\n                <EditAvatarPopup \n                    isOpen={isEditAvatarPopupOpen} \n                    onClose={closeAllPopups} \n                    onUpdateAvatar={handleUpdateAvatar}\n                /> \n\n                <AddPlacePopup\n                    isOpen={isAddPlacePopupOpen}\n                    onClose={closeAllPopups}\n                    onAddCard={handleAddPlaceSubmit}\n                />\n\n                <ImagePopup\n                    card={imageData}\n                    isOpen={selectedCard}\n                    onClose={closeAllPopups}\n                />\n\n                <div className=\"popup popup__submit\">\n                    <div className=\"popup__container\">\n                        <button type=\"button\" className=\"popup__close-btn\"></button> \n                        <div className=\"popup__content\">\n                            <h2 className=\"popup__title popup__title_submit\">Вы уверены?</h2>\n                            <form name=\"submit\" className=\"popup__form popup__form_update\">\n                                <button type=\"submit\" className=\"popup__save-btn popup__save-btn_confirm\">Да</button> \n                            </form>\n                        </div>\n                    </div>\n                </div>\n            </CurrentUserContext.Provider>\n        </div>\n    );\n}\n\nexport default App;\n "]},"metadata":{},"sourceType":"module"}